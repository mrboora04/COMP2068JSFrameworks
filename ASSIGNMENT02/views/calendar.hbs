<h1>Calendar</h1>
<h2>Upcoming Deadlines (Next 7 Days)</h2>
{{#if upcomingAssignments.length}}
  <ul class="list-group mb-4">
    {{#each upcomingAssignments}}
      <li class="list-group-item {{urgencyClass dueDate}}">
        <strong>{{title}}</strong> - Due: {{formatDate dueDate}} 
        ({{daysUntilDue dueDate}} days remaining) - 
        Weight: {{weight}}% - 
        {{#if completed}}Completed{{else}}Not Complete{{/if}}
        <div class="mt-2">
          <h6>To-Do List:</h6>
          {{#if todos.length}}
            <ul>
              {{#each todos}}
                <li>{{task}} - {{#if completed}}Completed{{else}}Pending{{/if}}</li>
              {{/each}}
            </ul>
          {{else}}
            <p>No to-dos yet.</p>
          {{/if}}
          <form action="/calendar/{{_id}}/add-todo" method="POST" class="mt-2">
            <div class="input-group">
              <input type="text" name="task" class="form-control" placeholder="Add a to-do" required>
              <button type="submit" class="btn btn-primary">Add</button>
            </div>
          </form>
        </div>
      </li>
    {{/each}}
  </ul>
{{else}}
  <p class="text-muted">No assignments due in the next 7 days.</p>
{{/if}}

<h2>All Assignments</h2>
<table class="table">
  <thead>
    <tr>
      <th>Title</th>
      <th>Due Date</th>
      <th>Priority</th>
      <th>Category</th>
      <th>Weight</th>
      <th>Status</th>
    </tr>
  </thead>
  <tbody>
    {{#each allAssignments}}
      <tr>
        <td>{{title}}</td>
        <td>{{formatDate dueDate}}</td>
        <td>{{priority}}</td>
        <td>{{category}}</td>
        <td>{{weight}}%</td>
        <td>{{#if completed}}Completed{{else}}Not Complete{{/if}}</td>
      </tr>
    {{else}}
      <tr>
        <td colspan="6">No assignments scheduled.</td>
      </tr>
    {{/each}}
  </tbody>
</table>
<a href="/dashboard" class="btn btn-secondary">Back to Dashboard</a>
<style>
  .urgent { background-color: #f8d7da; }
  .warning { background-color: #fff3cd; }
  .safe { background-color: #d4edda; }
</style>