<h1>Dashboard</h1>
<p>Welcome, {{user.username}}!</p>

{{#if debugMessage}}
  <div class="alert alert-info">{{debugMessage}}</div>
{{/if}}

<div class="mb-4">
  <a href="/export" class="btn btn-outline-primary me-2">Export to CSV</a>
  <a href="/add" class="btn btn-primary">Add Assignment</a>
</div>

<h2>Incomplete Assignments</h2>
{{#if incomplete.length}}
  {{#each incomplete}}
    <h4>{{course}}</h4>
    <div class="row">
      {{#each assignments}}
        <div class="col-md-4 mb-3">
          <div class="card {{urgencyClass dueDate}}">
            <div class="card-body">
              <h5>{{title}}</h5>
              <p><strong>Due:</strong> {{formatDate dueDate}} ({{daysUntilDue dueDate}} days)</p>
              <p><strong>Priority:</strong> {{priority}}</p>
              <p><strong>Notify:</strong> {{#if notify}}Yes{{else}}No{{/if}}</p>
              <p><strong>Status:</strong> Incomplete</p>
              <a href="/edit/{{_id}}" class="btn btn-outline-primary btn-sm me-2">Edit</a>
              <a href="/delete/{{_id}}" class="btn btn-outline-danger btn-sm" onclick="return confirm('Are you sure?')">Delete</a>
            </div>
          </div>
        </div>
      {{/each}}
    </div>
  {{/each}}
{{else}}
  <div class="alert alert-info">No incomplete assignments.</div>
{{/if}}

<h2>Completed Assignments</h2>
{{#if completed.length}}
  {{#each completed}}
    <h4>{{course}}</h4>
    <div class="row">
      {{#each assignments}}
        <div class="col-md-4 mb-3">
          <div class="card {{urgencyClass dueDate}}">
            <div class="card-body">
              <h5>{{title}}</h5>
              <p><strong>Due:</strong> {{formatDate dueDate}}</p>
              <p><strong>Priority:</strong> {{priority}}</p>
              <p><strong>Notify:</strong> {{#if notify}}Yes{{else}}No{{/if}}</p>
              <p><strong>Status:</strong> Completed</p>
              <a href="/edit/{{_id}}" class="btn btn-outline-primary btn-sm me-2">Edit</a>
              <a href="/delete/{{_id}}" class="btn btn-outline-danger btn-sm" onclick="return confirm('Are you sure?')">Delete</a>
            </div>
          </div>
        </div>
      {{/each}}
    </div>
  {{/each}}
{{else}}
  <div class="alert alert-info">No completed assignments.</div>
{{/if}}